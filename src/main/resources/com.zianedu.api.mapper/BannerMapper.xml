<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zianedu.api.mapper.BannerMapper">

    <select id="selectBannerInfoBySingle" resultType="BannerVO">
        SELECT
            VALUE_1 as fileUrl,
            VALUE_3 as colorCode,
            VALUE_4 as targetUrl,
            TYPE
        FROM T_CATEGORY_OTHER_INFO
        WHERE 1=1
        AND ctg_key = #{ctgKey}
        AND TYPE = 1
        ORDER BY POS ASC
    </select>

    <select id="selectBannerList" resultType="BannerVO">
        SELECT
            VALUE_1 as fileUrl,
            VALUE_3 as colorCode,
            VALUE_4 as targetUrl,
            TYPE
        FROM T_CATEGORY_OTHER_INFO
        WHERE ctg_key = #{ctgKey}
        AND TYPE = 1
        ORDER BY POS ASC
    </select>

    <select id="selectPopupList" resultType="PopupVO">
        SELECT B.NAME as popupName, B.contents
        FROM T_LINK_KEY A
        INNER JOIN T_POPUP B
        ON A.RES_KEY = B.POPUP_KEY
        WHERE A.REQ_KEY = #{ctgKey}
        AND A.REQ_TYPE = 100
        AND A.RES_TYPE = 300
        AND B.IS_SHOW = 1
        <![CDATA[
        AND TO_CHAR('YYYY-MM-DD', B.START_DATE) < TO_CHAR('YYYY-MM-DD', sysdate)
        ]]>
        <![CDATA[
        AND TO_CHAR('YYYY-MM-DD', B.START_DATE) >= TO_CHAR('YYYY-MM-DD', sysdate)
        ]]>
        ORDER BY A.POS ASC
    </select>

</mapper>
